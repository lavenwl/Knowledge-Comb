线索: 

1. 我们的测试人员一旦使用自己的手机号登录我们的产品, 第二天, 就会收到来自其他金融公司的推销电话
2. 进一步缩小操作范围, 确定在只要发送了验证码, 就会接到电话, 从而确定是发送验证码环节出了问题
3. 怀疑是存在代码注入, 两方面下手
   1. 发送验证码的后台服务检查代码逻辑, 是否存在代码注入的风险, #{}${} [SQL注入](https://www.cnblogs.com/myseries/p/10821372.html)
   2. 查看数据库binlog, 是否存在异常SQL查询. 发现有一个来源不明的SQL, 查询了短信发送表
4. 门店服务发布了最新版本的服务第二天观察现象, 发现还是存在这种问题
5. 换一种思路, 查看Nginx的转发日志, 发现一条带有类名路径参数的json个数请求. 进一步确认次请求是发送验证码的后台服务
6. 后台服务查询日志是否存在次条记录, 发现存在
7. 网上搜索这段代码格式发现为fastJSON漏洞
8. 漏洞: JSON反序列化是执行了传入类的invoke方法, 结合rmi调用了黑客代码. 代码打了一个socket洞, 远程获取管理员权限

解决: 提升fastJSON版本, 增加sql审查服务.

